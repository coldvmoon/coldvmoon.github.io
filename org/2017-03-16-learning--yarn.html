<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-03-30 周四 11:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title></title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc1ba286">1. Catalog <code>[25%]</code></a>
<ul>
<li><a href="#org78074ac">1.1. <span class="done DONE">DONE</span> Chapter 1：Starting with Yarn Basics</a></li>
<li><a href="#org3181a6f">1.2. <span class="todo TODO">TODO</span> Chapter 2：Setting up a Hadoop-Yarn Cluster</a></li>
<li><a href="#org76c2caa">1.3. <span class="todo TODO">TODO</span> Chapter 3: Administering a Hadoop-YARN Cluster</a></li>
<li><a href="#org19533c5">1.4. <span class="done DONE">DONE</span> Chapter 4: Executing Applications Using YARN</a></li>
<li><a href="#orga6a8cf7">1.5. <span class="done DONE">DONE</span> Chapter 5: Understanding YARN Life Cycle Management</a></li>
<li><a href="#org95e3d71">1.6. <span class="todo TODO">TODO</span> Chapter 6: Migrating from MRv1 to MRv2</a></li>
<li><a href="#org712e974">1.7. <span class="todo TODO">TODO</span> Chapter 7: Writing Your Own YARN Applications</a></li>
<li><a href="#orgc900a74">1.8. <span class="todo TODO">TODO</span> Chapter 8: Dive Deep into YARN Components</a></li>
<li><a href="#org057e2ad">1.9. <span class="todo TODO">TODO</span> Chapter 9: Exploring YARN REST Services</a></li>
<li><a href="#org445a3b4">1.10. <span class="todo TODO">TODO</span> Chapter 10: Scheduling YARN Applications</a></li>
<li><a href="#orgc150bc9">1.11. <span class="todo TODO">TODO</span> Chapter 11: Enabling Security in YARN</a></li>
<li><a href="#orgfa63962">1.12. <span class="todo TODO">TODO</span> Chapter 12: Real-time Data Analytics Using YARN</a></li>
</ul>
</li>
<li><a href="#orga4583a7">2. Overview</a></li>
<li><a href="#org5293ff7">3. Architecture</a></li>
<li><a href="#org16d3936">4. Feature</a></li>
<li><a href="#org8471cc0">5. Executing Application on Yarn</a>
<ul>
<li><a href="#org086f145">5.1. Phase 1 - Application initialization and submission</a></li>
<li><a href="#org314f1ab">5.2. Phase 2 - Allocate memory and start ApplicationMaster</a></li>
<li><a href="#org17e3a08">5.3. Phase 3 – ApplicationMaster registration and resource allocation</a></li>
<li><a href="#org7fb1bcf">5.4. Phase 5 – Application progress report</a></li>
<li><a href="#org5f86f4d">5.5. Phase 6 - Application completion</a></li>
</ul>
</li>
</ul>
</div>
</div>
---
layout: default
title: Learning Yarn
---



<div id="outline-container-orgc1ba286" class="outline-2">
<h2 id="orgc1ba286"><span class="section-number-2">1</span> Catalog <code>[25%]</code></h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-org78074ac" class="outline-3">
<h3 id="org78074ac"><span class="section-number-3">1.1</span> <span class="done DONE">DONE</span> Chapter 1：Starting with Yarn Basics</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>CLOSING NOTE <span class="timestamp-wrapper"><span class="timestamp">[2017-03-27 周一 15:45]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-org3181a6f" class="outline-3">
<h3 id="org3181a6f"><span class="section-number-3">1.2</span> <span class="todo TODO">TODO</span> Chapter 2：Setting up a Hadoop-Yarn Cluster</h3>
</div>
<div id="outline-container-org76c2caa" class="outline-3">
<h3 id="org76c2caa"><span class="section-number-3">1.3</span> <span class="todo TODO">TODO</span> Chapter 3: Administering a Hadoop-YARN Cluster</h3>
</div>
<div id="outline-container-org19533c5" class="outline-3">
<h3 id="org19533c5"><span class="section-number-3">1.4</span> <span class="done DONE">DONE</span> Chapter 4: Executing Applications Using YARN</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>CLOSING NOTE <span class="timestamp-wrapper"><span class="timestamp">[2017-03-27 周一 15:53]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-orga6a8cf7" class="outline-3">
<h3 id="orga6a8cf7"><span class="section-number-3">1.5</span> <span class="done DONE">DONE</span> Chapter 5: Understanding YARN Life Cycle Management</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>CLOSING NOTE <span class="timestamp-wrapper"><span class="timestamp">[2017-03-27 周一 15:53]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-org95e3d71" class="outline-3">
<h3 id="org95e3d71"><span class="section-number-3">1.6</span> <span class="todo TODO">TODO</span> Chapter 6: Migrating from MRv1 to MRv2</h3>
</div>
<div id="outline-container-org712e974" class="outline-3">
<h3 id="org712e974"><span class="section-number-3">1.7</span> <span class="todo TODO">TODO</span> Chapter 7: Writing Your Own YARN Applications</h3>
</div>
<div id="outline-container-orgc900a74" class="outline-3">
<h3 id="orgc900a74"><span class="section-number-3">1.8</span> <span class="todo TODO">TODO</span> Chapter 8: Dive Deep into YARN Components</h3>
</div>
<div id="outline-container-org057e2ad" class="outline-3">
<h3 id="org057e2ad"><span class="section-number-3">1.9</span> <span class="todo TODO">TODO</span> Chapter 9: Exploring YARN REST Services</h3>
</div>
<div id="outline-container-org445a3b4" class="outline-3">
<h3 id="org445a3b4"><span class="section-number-3">1.10</span> <span class="todo TODO">TODO</span> Chapter 10: Scheduling YARN Applications</h3>
</div>
<div id="outline-container-orgc150bc9" class="outline-3">
<h3 id="orgc150bc9"><span class="section-number-3">1.11</span> <span class="todo TODO">TODO</span> Chapter 11: Enabling Security in YARN</h3>
</div>
<div id="outline-container-orgfa63962" class="outline-3">
<h3 id="orgfa63962"><span class="section-number-3">1.12</span> <span class="todo TODO">TODO</span> Chapter 12: Real-time Data Analytics Using YARN</h3>
</div>
</div>
<div id="outline-container-orga4583a7" class="outline-2">
<h2 id="orga4583a7"><span class="section-number-2">2</span> Overview</h2>
<div class="outline-text-2" id="text-2">
<dl class="org-dl">
<dt>ResourceManager</dt><dd><code>A ResourceManager is a per cluster service that manages the scheduling of compute resources to applications. It optimizes cluster utilization in terms of memory, CPU cores, fairness, and SLAs.</code> To allow different policy constraints, it has algorithms in terms of pluggable schedulers such as capacity and fair that allows resource allocation in a particular way.
<dl class="org-dl">
<dt>Scheduler</dt><dd><code>This is a pure pluggable component that is only responsible for allocating resources to applications submitted to the cluster, applying constraint of capacities and queues.</code> Scheduler does not provide any guarantee for job completion or monitoring, it only allocates the cluster resources governed by the nature of job and resource requirement.</dd>
<dt>ApplicationsManager(AsM)</dt><dd><code>This is a service used to manage application masters across the cluster that is responsible for accepting the application submission, providing the resources for application master to start, monitoring the application progress, and restart, in case of application failure.</code></dd>
</dl></dd>
<dt>NodeManager</dt><dd><code>The NodeManager is a per node worker service that is responsible for the execution of containers based on the node capacity.</code> Node capacity is calculated based on the installed memory and the number of CPU cores. The  NodeManager service sends a heartbeat signal to the ResourceManager to update its health status. NodeManager also sends the status to ResourceManager, which could be the status of the node on which it is running or the status of tasks executing on it.</dd>
<dt>ApplicationMaster</dt><dd>An ApplicationMaster is a per application framework-specific library that manages each instance of an application that runs within YARN. YARN treats
<code>ApplicationMaster as a third-party library responsible for negotiating the resources from the ResourceManager scheduler and works with NodeManager to execute thetasks.</code> <code>The ResourceManager allocates containers to the ApplicationMaster and these containers are then used to run the application-specific processes.</code> ApplicationMaster also tracks the status of the application and monitors the progress of the containers. When the execution of a container gets complete, the ApplicationMaster unregisters the containers with the ResourceManager and unregisters itself after the execution of the application is complete.</dd>
<dt>Container</dt><dd><code>A container is a logical bundle of resources in terms of memory, CPU, disk, and so on that is bound to a particular node.</code> The ResourceManager scheduler service</dd>
</dl>
<p>
dynamically allocates resources as containers. A container grants rights to an ApplicationMaster to use a specific amount of resources of a specific host. An ApplicationMaster is considered as the first container of an application and it manages the execution of the application logic on allocated containers.
</p>
</div>
</div>

<div id="outline-container-org5293ff7" class="outline-2">
<h2 id="org5293ff7"><span class="section-number-2">3</span> Architecture</h2>
<div class="outline-text-2" id="text-3">

<div class="figure">
<p><img src="../images/Yarn-architecture_2017-03-23_15-01-20.png" alt="Yarn-architecture_2017-03-23_15-01-20.png" />
</p>
</div>

<ul class="org-ul">
<li>The ResourceManager service runs on the master node of the cluster.</li>
<li>A YARN client submits an application to the ResourceManager. An application can be a single MapReduce job, a directed acyclic graph of jobs, a java application, or any shell script.</li>
<li>The client also defines an ApplicationMaster and a command to start the ApplicationMaster on a node.</li>
<li>The ApplicationManager service of resource manager will validate and accept the application request from the client.</li>
<li>The scheduler service of resource manager will allocate a container for the ApplicationMaster on a node and the NodeManager service on that node will use the command to start the ApplicationMaster service.</li>
<li>Each YARN application has a special container called ApplicationMaster. The ApplicationMaster container is the first container of an application.</li>
<li>The ApplicationMaster requests resources from the ResourceManager. The RequestRequest will have the location of the node, memory, and CPU cores required.</li>
<li>The ResourceManager will allocate the resources as containers on a set of nodes.</li>
<li>The ApplicationMaster will connect to the NodeManager services and request NodeManager to start containers.</li>
<li>The ApplicationMaster manages the execution of the containers and will notify the ResourceManager once the application execution is over. Application execution and progress monitoring is the responsibility of ApplicationMaster rather than ResourceManager.</li>
<li>The NodeManager service runs on each slave of the YARN cluster. It is responsible for running application's containers. The resources specified for a container are taken from the NodeManager resources. Each NodeManager periodically updates ResourceManager for the set of available resources. The ResourceManager scheduler service uses this resource matrix to allocate new containers to ApplicationMaster or to start execution of a new application.</li>
</ul>
</div>
</div>

<div id="outline-container-org16d3936" class="outline-2">
<h2 id="org16d3936"><span class="section-number-2">4</span> Feature</h2>
<div class="outline-text-2" id="text-4">
<dl class="org-dl">
<dt>Scalability and higher cluster utilization</dt><dd><code>In YARN, the responsibility of resource management and job scheduling / monitoring is divided into separate daemons, allowing YARN daemons to scale the cluster without degrading the performance of the cluster.</code> With a flexible and generic resource model in YARN, the scheduler handles an overall resource profile for each type of application. This structure makes the communication and storage of resource requests efficient for the scheduler resulting in higher cluster utilization.</dd>
<dt>High availability for components</dt><dd>Fault tolerance is a core design principle for any multitenancy platform such as YARN. This responsibility is delegated to ResourceManager and ApplicationMaster. <code>The application specific framework, ApplicationMaster, handles the failure of a container. The ResourceManager handles the failure of NodeManager and ApplicationMaster.</code></dd>
<dt>Flexible resource model</dt><dd>In YARN, a resource-request is defined in terms of memory, CPU, locality, and so on. It results in a generic definition for a resource request by an application. The NodeManager node is the worker node and its capability is calculated based on the installed memory and cores of the CPU.</dd>
<dt>Multiple data processing algorithms</dt><dd>YARN is developed with a need to perform a wide variety of data processing over the data stored over Hadoop HDFS. YARN is a framework for generic resource management and allows users to execute multiple data processing algorithms over the data.</dd>
<dt>Log aggregation and resource localization</dt><dd>To manage user logs, YARN introduced a concept of log aggregation. In YARN, once the application is finished, the NodeManager service aggregates the user logs related to an application and these aggregated logs are written out to a single log file in HDFS. To access the logs, users can use either the YARN commandline options, YARN web interface, or can fetch directly from HDFS.</dd>
</dl>
</div>
</div>
<div id="outline-container-org8471cc0" class="outline-2">
<h2 id="org8471cc0"><span class="section-number-2">5</span> Executing Application on Yarn</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-org086f145" class="outline-3">
<h3 id="org086f145"><span class="section-number-3">5.1</span> Phase 1 - Application initialization and submission</h3>
<div class="outline-text-3" id="text-5-1">

<div class="figure">
<p><img src="../images/Yarn-phase-1_2017-03-26_20-22-09.png" alt="Yarn-phase-1_2017-03-26_20-22-09.png" />
</p>
</div>
<ol class="org-ol">
<li>In the first phase of application execution, <code>a client will connect to the applications manager service of the ResourceManager daemon and will request the ResourceManager for a new application ID.</code></li>
<li>The ResourceManager will validate the client request and if the client is an authorized user, <code>it will send a new and unique application ID, along with the cluster metrics to the client.</code></li>
<li><code>The client will use this application ID, and will submit an application to the ResourceManager.</code> The client will send ApplicationSubmissionContext along with the submission request. The submission context contains metadata information related to an application, such as application queue, name, and so on. It also contains the information to start the ApplicationMaster service on a particular node. The application submission is a blocking call which waits for the application completion.In the background, the ResourceManager service will accept the application and will allocate containers for application execution.</li>
</ol>
</div>
</div>
<div id="outline-container-org314f1ab" class="outline-3">
<h3 id="org314f1ab"><span class="section-number-3">5.2</span> Phase 2 - Allocate memory and start ApplicationMaster</h3>
<div class="outline-text-3" id="text-5-2">

<div class="figure">
<p><img src="../images/Yarn-phase-2_2017-03-26_20-22-09.png" alt="Yarn-phase-2_2017-03-26_20-22-09.png" />
</p>
</div>
<ol class="org-ol">
<li>The ResourceManager daemon starts an ApplicationMaster service on any of the NodeManager node. The scheduler service within the ResourceManager is responsible for the node selection. The basic criteria for selecting a node for the ApplicationMaster container is that the amount of memory required by the ApplicationMaster service should be available on that node.</li>
<li>The ApplicationSubmissionContext submitted by the client contains LaunchContext for the ApplicationMaster's container. The LaunchContext contains information such as the memory requirements for ApplicationMaster, command to start the ApplicationMaster, and so on.</li>
<li>The scheduler service of the ResourceManager daemon allocates memory specified in the LaunchContext and sends the context a NodeManager node to start the ApplicationMaster service.</li>
</ol>
</div>
</div>
<div id="outline-container-org17e3a08" class="outline-3">
<h3 id="org17e3a08"><span class="section-number-3">5.3</span> Phase 3 – ApplicationMaster registration and resource allocation</h3>
<div class="outline-text-3" id="text-5-3">

<div class="figure">
<p><img src="../images/Yarn-phase-3_2017-03-26_20-22-25.png" alt="Yarn-phase-3_2017-03-26_20-22-25.png" />
</p>
</div>
<ol class="org-ol">
<li>ApplicationMaster's container creates clients to communicate with the ResourceManager and NodeManager of the cluster.</li>
<li>The ApplicationMaster then registers itself with the ResourceManager using the AMRMClient service. It specifies the host and port for the container it is running on. While developing an application, a developer can also use AMRMClientAsync, an asynchronous implementation of the AppMaster ResourceManager client. It also sends a tracking URL for the application. The tracking URL is an application specific framework used to monitor the application execution.</li>
<li>The ResourceManager sends back the registration response with information related to access control lists, cluster capabilities, and access tokens</li>
<li>The ApplicationMaster requests the ResourceManager for containers allocation on the NodeManager nodes to execute the application tasks. The request includes the desired capabilities of the worker containers in terms of memory and CPU cores with the application priority. The optional parameters include nodes and racks specifications for execution of containers.</li>
<li>The ResourceManager iterates the list of asked containers, filters out the blacklisted</li>
</ol>
<p>
containers, and creates a list of containers to be released.
</p>
</div>
</div>
<div id="outline-container-org7fb1bcf" class="outline-3">
<h3 id="org7fb1bcf"><span class="section-number-3">5.4</span> Phase 5 – Application progress report</h3>
<div class="outline-text-3" id="text-5-4">

<div class="figure">
<p><img src="../images/Yarn-phase-5_2017-03-26_20-24-17.png" alt="Yarn-phase-5_2017-03-26_20-24-17.png" />
</p>
</div>
<ol class="org-ol">
<li>An application specific framework to monitor the application is exposed through the tracking URL for that application. The YARN client uses the tracking URL to</li>
</ol>
<p>
monitor the current status of an application. The tracking URL generally contains
the application metrics. For example, if the application is a MapReduce job, then the
tracking URL will expose the list of mappers and reducers for the job,
</p>
</div>
</div>
<div id="outline-container-org5f86f4d" class="outline-3">
<h3 id="org5f86f4d"><span class="section-number-3">5.5</span> Phase 6 - Application completion</h3>
<div class="outline-text-3" id="text-5-5">

<div class="figure">
<p><img src="../images/Yarn-phase-6_2017-03-26_20-24-35.png" alt="Yarn-phase-6_2017-03-26_20-24-35.png" />
</p>
</div>
<ol class="org-ol">
<li>On completion of an application, the ApplicationMaster sends out an un-registration request to the ResourceManager.</li>
<li>The ApplicationMaster terminates itself and releases the used memory back to the NodeManager. For an application, there is a final state and a final status. The ResourceManager marks the final state of the application as FINISHED. The final status of the application is set by the ApplicationMaster and is specific to the application executed.</li>
<li>The YARN client may interrupt the application execution at any point by sending a kill request to the ResourceManager. The ResourceManager kills the running containers for that application and changes the application status to completed.</li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2017-03-30 周四 11:22</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
